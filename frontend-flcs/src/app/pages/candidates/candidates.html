<div class="container-fluid p-4">
  <div class="d-flex justify-content-between align-items-center mb-4">
    <h2 class="fw-bold text-secondary">Liste des candidats</h2>
    <button class="btn btn-success shadow-sm">
      <i class="bi bi-plus-lg"></i> Ajouter candidat
    </button>
  </div>

  <div class="card border-0 shadow-sm rounded-3">
    <div class="card-body p-0">
      <div class="table-responsive">
        <table class="table table-hover align-middle mb-0">
          <thead class="bg-light">
            <tr>
              <th class="ps-4">Candidat</th>
              <th>Niveau</th>
              <th>Partenaire</th>
              <th>Statut</th>
              <th class="text-end pe-4">Actions</th>
            </tr>
          </thead>
          <tbody>
            <ng-container *ngFor="let candidat of candidats">
              <tr class="cursor-pointer">
                <td class="ps-4">
                  <div class="d-flex align-items-center">
                    <div class="avatar-sm me-3 bg-primary-subtle text-primary rounded-circle p-2 text-center" style="width: 40px;">
                      {{ candidat.nom[0] }}{{ candidat.prenom[0] }}
                    </div>
                    <div>
                      <div class="fw-bold">{{ candidat.nom }} {{ candidat.prenom }}</div>
                      <small class="text-muted">{{ candidat.dateNaiss }}</small>
                    </div>
                  </div>
                </td>
                <td>
                  <span class="badge bg-light text-dark border">{{ candidat.niveauScolaire }}</span>
                  <div class="small text-muted">Langue: {{ candidat.niveauLangue }}</div>
                </td>
                <td>
                  <span class="badge rounded-pill bg-primary-subtle text-primary">
                    {{ candidat.partenaire }}
                  </span>
                </td>
                <td>
                  <span [ngClass]="{
                    'badge bg-success-subtle text-success': candidat.typeProcedure === 'ACTIF',
                    'badge bg-warning-subtle text-warning': candidat.typeProcedure !== 'ACTIF'
                  }">{{ candidat.typeProcedure }}</span>
                </td>
                <td class="text-end pe-4">
                  <div class="btn-group">
                    <button class="btn btn-sm btn-light border" (click)="candidat.isExpanded = !candidat.isExpanded">
                      <i class="bi" [ngClass]="candidat.isExpanded ? 'bi-chevron-up' : 'bi-chevron-down'"></i>
                    </button>
                    <button class="btn btn-sm btn-outline-success" (click)="editCandidat(candidat)">
                      <i class="bi bi-pencil"></i>
                    </button>
                    <button class="btn btn-sm btn-outline-danger" (click)="deleteCandidat(candidat.id)">
                      <i class="bi bi-trash"></i>
                    </button>
                  </div>
                </td>
              </tr>

              <tr *ngIf="candidat.isExpanded" class="bg-light-subtle">
                <td colspan="5" class="p-4">
                  <div class="row g-3">
                    <div class="col-md-3">
                      <label class="small text-muted d-block">Téléphone Candidat</label>
                      <strong>{{ candidat.telCandidat }}</strong>
                    </div>
                    <div class="col-md-3">
                      <label class="small text-muted d-block">Téléphone Parent</label>
                      <strong>{{ candidat.telParent }}</strong>
                    </div>
                    <div class="col-md-3">
                      <label class="small text-muted d-block">Rentrée prévue</label>
                      <strong>{{ candidat.rentree }}</strong>
                    </div>
                    <div class="col-md-3">
                      <label class="small text-muted d-block">ID Interne</label>
                      <span class="badge bg-secondary">#{{ candidat.id }}</span>
                    </div>
                  </div>
                </td>
              </tr>
            </ng-container>
          </tbody>
        </table>
      </div>

      <div *ngIf="loading" class="text-center p-5">
        <div class="spinner-border text-primary"></div>
        <p class="mt-2">Chargement de la liste...</p>
      </div>

      <div *ngIf="!loading && candidats.length === 0" class="text-center p-5">
        <i class="bi bi-people text-muted display-4"></i>
        <p class="mt-3">Aucun candidat pour le moment.</p>
      </div>
    </div>
  </div>
</div>